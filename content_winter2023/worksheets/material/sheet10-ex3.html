<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Set 1</title>

<link rel="stylesheet" href="css/missing-css.css">
<link rel="stylesheet" href="css/prism-coy-23.css">
<script src="css/prism-coy-23.js"></script>
<link href="https://fonts.bunny.net/css?family=source-sans-3:400,700|m-plus-code-latin:400,700" rel="stylesheet">

<style>
    :root {
        --main-font: "Source Sans 3", -apple-system, system-ui, sans-serif;
    }
    dfn > code {
        font-style: normal;
        text-decoration: 1px dashed var(--muted-fg) underline;
    }
    code a {
        font-family: inherit;
    }
    details {
      position:fixed;
      top:61px;
      left:0;
      max-width: 500px;
    }
</style>
</head>
<body>

<header>
  <nav class="breadcrumbs" aria-label="Breadcrumbs">
    <ol>
      <li><a href="#"  class="allcaps">SYST10199</a></li>
      <li><a href="#">Worksheet 10</a></li>
      <li><a href="#" aria-current="page">Exercise 3: Registration and Login forms</a></li>
    </ol>
  </nav>
</header>

<main>
<h1>Exercise 3: Registration and Login forms</h1>



<details>
<summary>On this page&hellip;</summary>
 <ol>
    <li><a href="#e01">STEP 1: Create an html document containing a form (from earlier assignment)</a></li>
    <li><a href="#e02">STEP 2: Use phpMyAdmin web tool, to set up table</a></li>
    <li><a href="#e02">STEP 3-6: To process the form with PHP, you need to connect and work with databases</a></li>
  </ol>
</details>
 
<h3>STEP 1: Create an html document containing a form (from Assignment 6)</h3>
<p>NOTE: Code includes only the fields needed for BOTH the login and registration form; it is up to you to include and complete the remaining fields from the registration form.</p>
 
<h3>STEP 2: Use phpMyAdmin web tool, to set up table</h3>
<p>Either manually (as demonstrated in class) or using SQL tab in phpMyadmin, create a table to correspond to (you make up your own values):</p>
<figure>
<pre class="language-sql" tabindex="0"><code class="language-sql">CREATE TABLE `members` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `startdate` date NOT NULL,
  `player` varchar(40) NOT NULL,
  `password` varchar(20) NOT NULL
  PRIMARY KEY (`id`)
);
INSERT INTO `members` 
(`id`, `startdate`, `player`, `password`) 
VALUES
(1, '2016-07-14', 'ellen', 'elephant'),
(2, '2016-07-06', 'charlie', 'cherries');
</code></pre>
  <figcaption>Figure 1: minimal fields for table used for login form and registration form in this example.</figcaption>
</figure>

<h3>STEP 3-6: To process the form with PHP, you need to connect and work with databases</h3>


<ul>
    <li>Add a subdirectory “includes” to you project.</li>
    <li>Create a new file and name it <code>Member.class</code>, store in subdirectory “includes” in your project.</li>
    <li><strong>Member.class code </strong> Start with the code found in FIGURE 2.</li>
    <li>Add the authenticate method to your Memeber.class. See FIGURE 4.</li>
    <li><strong>Login form processing</strong> Note: remember to include session_start() at the top of the page AND use the .php extension for every file that contains PHP code (even if you do not see it here). On your login page, add the code from FIGURE 3.</li>
    <li><strong>Registration form processing</strong> On your submission of the registration form page, add code from FIGURE 4.</li>
    <li>Add the registerMember method to your Member.class. See FIGURE 4</li>
    <li>Note the use of error_log(). You can customize your error message. See PHP manual for more details.</li>
</ul>


<figure>
<pre class="language-php" tabindex="0"><code class="language-php">&lt;?php
/* Class name: 	Member
 * Description: A class that creates a User 
 *              for members-only web app.
 * Citation:	PHP, MySQL, Javascript & HTML5 for Dummies, 
 *              S.Suehring, J.Valade
 * Member is a data-aware class; data source 
 * that connects to a database
 * |----------------------------------------
 * | $id
 * | $firstName
 * | $password
...

 * | $isLoggedIn
 * |----------------------------------------
 * | __construct
 * | registerMember($safeUser, $newPass)
 * | authenticate($user, $pass)
 * | _initUser()
 * | _setSession()
 * |----------------------------------------
 */
 class Member {
	private $id;
	private $firstName;
	private $password;	
	// TODO: add others fields from the registration form 
    // (don't forget to add them in methods appropriately
 
	/* Constructor: 
	 * starts session and calls_initUser() method 
     * to initialize user info
	 */
	function __construct() {
		if (session_id() == "") {
			session_start();
		}
		$this->_initUser();
	}     
	// TODO: add other methods
    
	/* 
	 *  private function _initUser() called by the constructor
	 */
	private function _initUser() {
		if (session_id() == '') {
			session_start();
		}		
		$this->id = $_SESSION['id'];
		$this->firstName = $_SESSION['firstName'];
		$this->password = $_SESSION['password'];
		$this->isLoggedIn = $_SESSION['isLoggedIn'];
	}
	
	/* 
	 *  public function _setSession() 
     *  called from authenticate() function
	 */
	private function _setSession() {
		$_SESSION['id'] = $this->id;
		$_SESSION['firstName'] = $this->firstName;
		$_SESSION['password'] = $this->password;
		$_SESSION['isLoggedIn'] = $this->isLoggedIn;
	}	

 } // end class Member
 ?>
</code></pre>
  <figcaption>Figure 2: Code for Member.class.</figcaption>
</figure>


<h3></h3>
<p></p>
<p>On your login page, add the following</p>
<figure>
<pre class="language-php" tabindex="0"><code class="language-php">if ($_SERVER['REQUEST_METHOD'] == 'POST') {	
	$_SESSION['formAttemp'] = true;
	$_SESSION['id'] = session_id();
	$_SESSION['isLoggedIn'] = false;

	if (isset($_POST['password']))
		if (!empty($_POST['password'])) 
			$_SESSION['password'] = $_POST['password'];
	if (isset($_POST['username']))
		if (!empty($_POST['username'])) {
			$safeuser = $_POST['username'];
			$_SESSION['firstName'] = $_POST['username'];
		} else {
		  // handle the bad name!
		}	
	require_once("includes/Member.class");
	$visitor = new Member;
	if ($visitor->authenticate($_POST['username'], 
                               $_POST['password'])) {	
		// proceed to member site 
		// TODO: start with a simple message that it worked
	} else {
		session_destroy();	
		// TODO: authentication unsuccessful, return to login
	}
}
</code></pre>
  <figcaption>Figure 3: Login form processing. Note: remember to include session_start() at the top of the page AND use the .php extension for every file that contains PHP code (even if you do not see it here).</figcaption>
</figure>




<h3></h3>
<p></p>
<figure>
<pre class="language-js" tabindex="0"><code class="language-js">

</code></pre>
  <figcaption>Figure 4: </figcaption>
</figure>








<figure>
    <img src="img/" 
         alt="Figure 1: caption.">
    <figcaption>Figure 1: caption.</figcaption>
</figure>

<ul class="f-switch dense align-items:stretch" role="list">
    <li class="box"><strong>dfd</strong> sdfd.</li>
    <li class="box"><strong>dfd</strong> sdfd.</li>
    <li class="box"><strong>dfd</strong> sdfd.</li>
</ul>





<h2 id="e02">Exercise 1.2</h2>
<p></p>



</main>

<footer>
              <p id="version" class="leading-none mb-2 my-4">&copy;  This work is the intellectual property of Sheridan College. Any further copying and distribution outside of class must be within the copyright law. Posting to commercial sites for profit is prohibited.</p>
         <p class="text-sm text-gray-100 md:mb-6">
         <a class="text-white" href="">SYST10109 Web Programming | Sheridan College</a>
      </p>  
          <ul  class="f-switch dense align-items:stretch" role="list">

            <li class="list-none row-span-2">
              <h2 class="text-base font-semibold tracking-wide">Course Material</h2>
              <ul class="list-none space-y-4 md:space-y-1 px-0">
                <li><a href="https://ulysses.sheridanc.on.ca/coutline/coutlineview_sal.jsp?appver=sal&subjectCode=SYST&courseCode=10199&version=2021011800&sec=0&reload=true">Course Outline</a></li>      
                <li><a href="https://notepad-plus-plus.org/">Notepad++ Text Editor</a></li>  
                <li><a href="https://www.filezilla-project.net/">FileZilla Client</a></li>  
                <li><a href="https://www.w3schools.com/tryit/trycompiler.asp?filename=demo_php">Online Backend editor (PHP)</a></li>  
                <li><a href="https://www.w3schools.com/tryit/tryit.asp?filename=tryhtml_hello">Online Frontend editor (HTML/CSS/JS)</a></li>
                <li><a href="https://validator.w3.org/">HTML validator</a></li>   
                <li><a href="https://jigsaw.w3.org/css-validator/">CSS validator</a></li>                  
              </ul>
            </li>
            <li class="list-none row-span-2">
              <h2 class="text-base font-semibold tracking-wide">Resources</h2>
              <ul class="list-none space-y-4 md:space-y-1 px-0">
                <li><a href="https://www.w3.org/">World Wide Web Consortium (W3C)</a></li>
                <li><a href="https://developer.mozilla.org/en-US/">MDN Web Docs</a></li>
                <li><a href="https://www.w3schools.com/">w3schools</a> </li>  
                <li><a href="https://www.php.net/manual/en/index.php">PHP Manual</a></li>   
                <li><a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-262/">ECMAScript language specification</a></li>                 
              </ul>
            </li>
            <li class="list-none row-span-2">
              <h2 class="text-base font-semibold tracking-wide">Sheridan College</h2>
              <ul class="list-none space-y-4 md:space-y-1 px-0">
                <li><a href="https://www.sheridancollege.ca/">Davis &mdash; HMC &mdash; Trafalgar</a></li>
                 <li><a href="https://central.sheridancollege.ca/counselling-services">Wellness &amp; Counselling Services</a></li>   
                 <li><a href="https://central.sheridancollege.ca/library-services">Library Services</a></li>  
                 <li><a href="https://it.sheridancollege.ca/service-catalogue/tech-essentials/index.html">Tech Essentials</a></li>                  
                <li>
                  <a href="http://bajcar.dev.fast.sheridanc.on.ca/">Prof. Ellen Bajcar</a>
                  <span style="color:gray"><br>Office hours (by appointment)</span>
                </li>
                <li><a href="https://slate.sheridancollege.ca/d2l/home">SLATE</a></li>  
                <li><a href="http://tech.fast.sheridanc.on.ca/">Fast Tech (web server access)</a></li>
              </ul>
            </li>
          </ul>
</footer>
	
</body>
</html>