<!DOCTYPE html>
<html lang="en">
<head>
<title>Play Number Scrabble</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- 
Author: Ellen Bajcar
Program: bingo.html
Date: Summer 2016
Date Updated: Fall 2019
Version: 19.0 
Purpose: learning Javascript programming
Copyright: 
    This work is the intellectual property of Sheridan College. 
    Any further copying and distribution outside of class must be within 
    the copyright law. Posting to commercial sites for profit is prohibited.
Description:
    Interface for a bingo card
    Functionality for a bingo card (game board) and calling numbers (caller)
    See also: 
        Javascript, Eighth Ed., Negrino & Smith
        https://piazza.com/class/inrun9m79bc5q2?cid=15
    Bingo terminology: 
        http://blog.casinocashjourney.com/2013/01/18/bingo-terms/
-->	
<style>
@import url('https://fonts.googleapis.com/css?family=Kaushan+Script&display=swap');

:root {
  --body-bg-color: #a2a2a2;
  --tiles-bg-color: rgba(255, 255, 255, 0.8);
  --tiles-bg-color-hover: rgba(230, 230, 230, 0.8);
  --tiles-blue-bg-color: #4f62ff;
  --tiles-red-bg-color: #d22f2f;
  --cell-size: 50px;
  --cell-spacing: 10px;
  --title-height: 30px;
  --reset-height: 50px;
}

/* 
grid used for the core content: games 
In this section:
    :root{}
    .grid-container{}
    .grid-item{}
    .grid-item:last-child{}
*/
.grid-container {
	/*background-image: linear-gradient(to top right, var(--sherorange), var(--sherteal), var(--sherteal), var(--sherblue));*/
	min-width: 700px;
	display: grid;
	grid-template-columns: 65% auto;
	grid-gap: var(--gap-sm);
	min-height: 300px;
	padding: 10px;
}
.grid-item {
	/*background-color: var(--body-bg-color);*/
    border: 1px dotted lightgray;
	padding: 10px;
	text-align: center;
}
.grid-item:last-child {
	/*color: var(--sherblue);*/
	text-align: left;
}


body {
	background: #e0e0e0;
    font-family: 'Kaushan Script', cursive;
    margin: 0 auto;
    text-align: center;
}
main {
	width: 100%;
	margin: auto;
	padding-top: 4px;
	background-color: white;
	min-height: 380px;
	display: flex;
	justify-content: center;	
}
main > div {
  margin: 5px;
  padding: 5px;
}
header h1, dialog h2 {
	color: #6f6f6f;   
	text-shadow: 1px 1px cyan;
    font-size: 60px;
    font-weight: 400;
	margin: 16px 0 0;
    text-align: center;
}
dialog h2 {
	font-size: 40px;
}
footer {
	margin: auto;
	padding-top: 10px;
	margin-top: 10px;
	text-align: center;
	color: gray;
	clear: both;
}
button {
  padding: 1rem;
  border: 1px solid #ccc;
  background-color: #ddd;
  -webkit-transition: background-color 200ms ease;
  transition: background-color 200ms ease;
  width: 100%;
  box-shadow: 1px 1px 3px gray;
}
button:hover {
  cursor: pointer;
  background-color: #eee;
}




/* navigation */
nav {
    margin: 20px auto;
    width: 450px;
	text-align: center;
}
nav a, nav span {
    background-color: #a4a4a4;
	color: #fff;
    display: inline-block;
	font-family: Lato, sans-serif;
    font-size: 15px;
    padding: 7px;
    text-decoration: none;
}
nav a.active, nav a:hover, nav span:hover {
    background: #c2c2c2;
    color: #818181;
    cursor: pointer;
}




dialog {
	position: fixed;
	top: 50%;
	transform: translate(0, -50%);
	background: #e0e0e0;
	padding: 3px;
	border: 1px solid gray;
	box-sizing: border-box;
	width: 50%;
}
dialog section {
	width: 100%;
	margin: 0;
	padding: 0;
	background-color: white;
	text-align: left;
	padding: 3px;
	box-sizing: border-box;
	height: 300px;
	overflow-y: scroll;
	overflow-x: hidden;
}
dialog p {
	font-family: initial;
}


.scrabble  {
    margin: auto;
    text-align: center;
}
p, td {
	text-align: center;
}
.scrabble img {
  cursor: grab;
  height: 2.7em;
  opacity: 0.8;
}
.scrabble td { 
	border: gray solid; 
	height: 3.1em; 
	width: 3.1em; 
    vertical-align: bottom;
}
.scrabble dl, dt, dd, ul {
    margin: 0;
    padding: 0;
}
.scrabble dt {
    font-size: 1.2em;
    font-weight: bold;
}
.scrabble dd, ul {
    text-align: left;
    padding: 0 0 15px 15px;
}
.scrabble dt:first-child button {
    width: 100%;
}
.out1 {
    visibility: hidden;
}
.flashing {
  animation-name: example;
  animation-duration: 4s;
  animation-iteration-count: 3;
}
@keyframes example {
  0% {border:2px solid teal;box-shadow: 1px 1px 2px gray;}
  20% {border:2px solid orange;box-shadow: 1px 1px 2px gray;}
  40% {border:2px solid red;box-shadow: 1px 1px 2px gray;}
  60% {border:2px solid darkorange;box-shadow: 1px 1px 2px gray;}  
  80% {border:2px solid ornage;box-shadow: 1px 12px 2px ornage;}  
  100% {border:2px solid teal;box-shadow: 1px 1px 2px gray;}
}
#out2 {
  font-family: monospace;
  font-size: 1em;
}
</style>
</head>
<body>
    <header><h1>Play Number Scrabble</h1></header><!-- create a bingo card -->
	<nav>
		<a href="">Home</a>
        <a  id="gameReset" href="">New Game</a>
        <span id="help" >Help</span>
	</nav>		
	<main>
			<div class="grid-container">
				<div class="grid-item">
                     <table class="scrabble">
                       <tr>
                         <td></td>
                         <td></td>
                         <td></td>
                       </tr>
                       <tr>
                         <td></td>
                         <td></td>
                         <td></td>
                       </tr>   
                       <tr>
                         <td></td>
                         <td></td>
                         <td></td>
                       </tr>     
                    </table>
                     <p>
                        <img src="images/1.png" id="one" width="40" draggable="true" alt="1">
                        <img src="images/2.png" id="two" width="40" draggable="true" alt="2">
                        <img src="images/3.png" id="three" width="40" draggable="true" alt="3">
                        <img src="images/4.png" id="four" width="40" draggable="true" alt="4">
                        <img src="images/5.png" id="five" width="40" draggable="true" alt="5"> 
                        <img src="images/6.png" id="six" width="40" draggable="true" alt="6">
                        <img src="images/7.png" id="seven" width="40" draggable="true" alt="7">
                        <img src="images/8.png" id="eight" width="40" draggable="true" alt="8">
                        <img src="images/9.png" id="nine" width="40" draggable="true" alt="9">
                    </p>                     
				</div>
				<div class="grid-item">
                    <dt><h5 id="player"></h5></dt>    
                    <dd id="out"></dd>
                    <dt id="out1"><h5>Endgame Board State</h5></dt>
                    <dd id="out2"></dd>                    
				</div>
			</div>	     
	</main>
    <footer><address>SYST10199 Web Programming &copy; Sheridan College</address></footer>
    
    <dialog id="dialog0">
        <h2>Help</h2>
       <section>
        <h3>Rules</h3>
        <p>Maecenas vitae vehicula nulla, sed mattis sem. Etiam aliquam id justo et tincidunt. Morbi arcu nulla, maximus eu viverra in, dignissim in lacus. Duis interdum ante lacus, sed sollicitudin diam sodales nec. Praesent vestibulum risus congue massa bibendum, sed finibus justo auctor. Cras tempus et leo non venenatis. Vivamus sed aliquam metus. Sed consequat vehicula quam molestie vestibulum. Sed dolor nulla, volutpat id tempus consectetur, hendrerit id justo. Quisque turpis orci, imperdiet quis malesuada eu, dictum vitae eros.</p>
        <p>Maecenas vitae vehicula nulla, sed mattis sem. Etiam aliquam id justo et tincidunt. Morbi arcu nulla, maximus eu viverra in, dignissim in lacus. Duis interdum ante lacus, sed sollicitudin diam sodales nec. Praesent vestibulum risus congue massa bibendum, sed finibus justo auctor. Cras tempus et leo non venenatis. Vivamus sed aliquam metus. Sed consequat vehicula quam molestie vestibulum. Sed dolor nulla, volutpat id tempus consectetur, hendrerit id justo. Quisque turpis orci, imperdiet quis malesuada eu, dictum vitae eros.</p>
        <p>Maecenas vitae vehicula nulla, sed mattis sem. Etiam aliquam id justo et tincidunt. Morbi arcu nulla, maximus eu viverra in, dignissim in lacus. Duis interdum ante lacus, sed sollicitudin diam sodales nec. Praesent vestibulum risus congue massa bibendum, sed finibus justo auctor. Cras tempus et leo non venenatis. Vivamus sed aliquam metus. Sed consequat vehicula quam molestie vestibulum. Sed dolor nulla, volutpat id tempus consectetur, hendrerit id justo. Quisque turpis orci, imperdiet quis malesuada eu, dictum vitae eros.</p>
      </section>
      <h4 id="close">Click here to dismiss this box.</h4>
    </dialog>
<script>
/* 
Author: Ellen Bajcar
Program: bingo.js
Date: Summer 2016
Date Updated: 8:25 AM June-09-16
Version: 5.0 (Week 5 stage)
 *	Purpose: learning Javascript programming
 *	Copyright: 
 *		This work is the intellectual property of Sheridan College. 
 *		Any further copying and distribution outside of class must be within 
 *		the copyright law. Posting to commercial sites for profit is prohibited.
 *	Description:
 *		Functionality for a bingo card (game board) and calling numbers (caller)
 *			funtion createBoard() includes click event listener
 *			function populateCard()
 *			function createCaller()
 *			function initAll() calls createBoard, populateCard, createCaller
 *							   creates theCard
 *			function getNewNumber()
 *			function reloadPage()
 *			function checkWinningCombos()
 *			function handleClick()
 *			Event Listeners ... DOMContentLoaded, click (next, reset)
 *		Variables: 
 *				nor, noc, gameOver, theCard, usedNums, calledNums,availNums, winSets
 *		See also: 
 *			Javascript, Eighth Ed., Negrino & Smith
 *			https://piazza.com/class/inrun9m79bc5q2?cid=15
 *		Bingo terminology: 
 *			http://blog.casinocashjourney.com/2013/01/18/bingo-terms/
 * 	Future enhancements:
 *		TODO: resolve any conflicts between a number being called and user deselecting a called number
 *		TODO: !!! resolve if user clicks a number that has not been called
 *		DONE: what about the four-corners winning combo? 
 *		TODO: add full face winning, continue play until card full
 *		see http://textillate.js.org/ for text animation
 */

"use strict;"
document.getElementById("help").onclick = function() {
  document.getElementById("dialog0").setAttribute("open", "open");
}
document.getElementById("close").onclick = function() {
    document.getElementById("dialog0").removeAttribute("open");
}
 
// image source: https://paradite.com/wp-content/uploads/2017/09/numbers-1336520_960_720-620x279.jpg
// game trees: https://en.wikipedia.org/wiki/Game_tree
// number scrabble: https://en.wikipedia.org/wiki/Number_Scrabble
// https://glitch.com/~accidental-country similar application of drag and drop

// TODO: replace with unload function to remove all nodes used for this game
// reloads the page - everything is reset 

document.getElementById("gameReset").onclick = function() { 
    //console.log("restart clicked");
    location.reload(); 
};

var board = [0,0,0,0,0,0,0,0,0];
var cells = document.getElementsByTagName("td");
for (var i = 0; i < 9; i++) {
    cells[i].boardIndex = i;
    //console.log(cells[i].boardIndex);
    cells[i].ondrop = function() {drop(this, event)};
    cells[i].ondragenter = function() {return false};
    cells[i].ondragover = function() {return false};
}

var items = document.getElementsByTagName("img");
for (var i = 0; i < items.length; i++)
    items[i].ondragstart = function() {drag(this, event)};

function allowDrop(ev) {
  ev.preventDefault();
}

function drag(target, ev) {
 ev.dataTransfer.setData('Text', target.id);
}

function drop(target, ev) {
// allow drop only if the cell is empty
 if (target.children.length == 0) {
     var id = ev.dataTransfer.getData('Text');
     target.appendChild(document.getElementById(id));
     document.getElementById(id).setAttribute("draggable","false");
     document.getElementById(id).style.cursor = 'no-drop';
     target.style.border = (count % 2 === 0)
                                ? "3px solid orange" 
                                : "3px solid teal";
     board[target.boardIndex] = document.getElementById(id).alt;
     ev.preventDefault();
     checkStatusOfBoard(target.boardIndex);
     count++;
 }
}
    var count = 1,
		flag = false,
		totals = [0,0,0,0,0,0,0,0],
		results = [
        { name: "row1", boardCells:  [0,1,2], runningTotal: 0, complete: false },
        { name: "row2", boardCells:  [3,4,5], runningTotal: 0, complete: false  },
        { name: "row3", boardCells:  [6,7,8], runningTotal: 0, complete: false  },
        { name: "col1", boardCells:  [0,3,6], runningTotal: 0, complete: false  },
        { name: "col2", boardCells:  [1,4,7], runningTotal: 0, complete: false  },
        { name: "col3", boardCells:  [2,5,8], runningTotal: 0, complete: false  },
        { name: "diag1", boardCells:  [0,4,8], runningTotal: 0, complete: false  },
        { name: "diag2", boardCells:  [2,4,6], runningTotal: 0, complete: false  }
        ];

function isItCompletelyFilled() {
    
}      
  
function checkStatusOfBoard(lastNumberPlaced) {
    // check calculations and update states      
    for (let i = 0; i < 8; i++) {
        let a = parseInt(board[results[i].boardCells[0]]),
            b = parseInt(board[results[i].boardCells[1]]),
            c = parseInt(board[results[i].boardCells[2]]);
        results[i].runningTotal = a + b + c;
        totals[i] =  results[i].runningTotal;        
        if (a === 0 || b === 0 || c === 0 ) {
            console.log("not all cells placed");
        } else {
          if (!results[i].complete)
            //console.log("ready to evaluate " + results[i].name + " cells " + results[i].boardCells);
            results[i].complete = true;
        }   
        if (!flag && totals.indexOf(15) > -1 && results[i].complete) { 
          //console.log(results[totals.indexOf(15)].boardCells.includes(0)); 
          let curPlayer = (count % 2 === 0)? "player o" : "player x";
          document.getElementById("out").innerText += "first total of 15 reached on : " + results[i].name + 
            "\nlast cell placed in cell : "+ lastNumberPlaced + 
            "\n on turn : " + count +
            "\n by : " + curPlayer;
          flag = true;
        }
    }
    // when all cells are filled, display results of all combinations
    if (!board.includes(0)) {
      var parentEl = document.getElementById("out2").appendChild(document.createElement("ul"))
      for (let j = 0; j < 8; j++) {
          var newLi = document.createElement("li");
          newLi.innerText = results[j].name + " total is " + results[j].runningTotal;
          parentEl.appendChild(newLi);
        if (totals[j] === 15) {  
          newLi.style.fontWeight = "bold";
          newLi.style.color = "red";
        }
      }
    }
}
</script>

</body>
</html>


